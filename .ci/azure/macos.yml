steps:
- script: |
    top -l 1 -s 0 | grep PhysMem
    system_profiler | grep Processor
    sysctl hw
    df -h
  displayName: Dump VM specs

- script: printenv
  displayName: Dump environment variables

- script: |
    set -e
    cd ..
    git clone --depth=100 --no-single-branch https://github.com/$WRF_REPO.git WRF
    cd WRF
    git checkout $WRF_COMMIT
    .ci/azure/scripts/setup-dependencies.sh
    .ci/azure/scripts/install-wrf.sh
  displayName: Install dependencies & WRF

- script: .ci/azure/scripts/install-wps.sh
  displayName: Install WPS

#- task: PublishPipelineArtifact@0
#  displayName: Publish binaries
#  condition: and(succeeded(), eq(variables.BUILD_SYSTEM, 'cmake'))
#  inputs:
#    artifactName: binaries_$(OS_NAME)_$(BUILD_SYSTEM)_$(BUILD_TYPE)_$(MODE)
#    targetPath: build/install/main
